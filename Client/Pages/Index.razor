@page "/"
@using System.Text.Json;
@using System.Text.Json.Serialization;
@using CanvasComponent.Convertors;
@using CanvasComponent.Facade;
@using CanvasComponent.Model;
@using CanvasComponent.View;
@inject Project Project;

<PageTitle>Index</PageTitle>

<h1>Hello, world!</h1>

<p style="margin-bottom: 1rem;">
    Welcome to your new app.
</p>

<FluentDesignSystemProvider FillColor="#D6D6D6">
    <FluentCard neutral-palette-source="#CABA8C">
        <CanvasContainer Project="@project" />
    </FluentCard>
</FluentDesignSystemProvider>

@code {
    private string project;

    protected override void OnParametersSet()
    {
        JsonSerializerOptions options = new()
            {
                IgnoreReadOnlyProperties = true,
                DefaultIgnoreCondition = JsonIgnoreCondition.WhenWritingNull,
                IncludeFields = true
            };
        options.Converters.Add(new ProjectConverter());
        options.Converters.Add(new ISmartDeviceConverter());
        options.Converters.Add(new LineConverter());
        options.Converters.Add(new RoomConverter());
        project = JsonSerializer.Serialize(Project, options);
    }
}

